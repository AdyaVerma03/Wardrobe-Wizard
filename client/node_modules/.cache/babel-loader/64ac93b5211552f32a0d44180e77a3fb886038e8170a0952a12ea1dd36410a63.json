{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\OneDrive\\\\Documents\\\\GitHub\\\\Wardrobe-Wizard\\\\client\\\\src\\\\components\\\\StartStyling\\\\StartStyling.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport \"./StartStyling.scss\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { hasImages, clearImages, storeImages } from \"../../utils/indexDB\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport Box from \"@mui/material/Box\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StartStyling = ({\n  style,\n  setStyle,\n  response,\n  setResponse,\n  images\n}) => {\n  _s();\n  const [errors, setErrors] = useState({});\n  const [request, setRequest] = useState(false); // the loading state\n  const [apiCallFinished, setApiCallFinished] = useState(false);\n  const base_url = process.env.REACT_APP_BASE_URL;\n  const navigate = useNavigate();\n  const handleStyleClick = style => {\n    setStyle(style);\n  };\n  const styles = [\"Streetwear\", \"Boho-chic\", \"Casual\", \"Business Casual\", \"Formal\", \"Minimalist\", \"Elegant\", \"Athleisure\", \"Girly girl\", \"NYC Style\", \"Preepy Fashion\", \"Punk Fashion\", \"Gothic Fashion\"];\n  //clear out the old images stored in indexDB upon reload of this page\n  useEffect(() => {\n    const clearDatabase = async () => {\n      try {\n        const ImagesStoreHasData = await hasImages();\n        if (!ImagesStoreHasData) {\n          return;\n        }\n        await clearImages();\n      } catch (error) {\n        setErrors(prevErrors => ({\n          ...prevErrors,\n          db: \"Failed to clear history images, please try again\"\n        }));\n      }\n    };\n    clearDatabase();\n  }, []);\n  useEffect(() => {\n    if (apiCallFinished && response.length > 0) {\n      // ensure gpt4 has send back meaningful resonse\n      navigate(\"/recommendations\");\n      setApiCallFinished(false); // Reset the flag after navigating\n    }\n  }, [apiCallFinished]); // re-render the page when the response is upadated\n\n  const handleClick = async () => {\n    const errors = {};\n    if (!style) {\n      errors.style = \"Please selected a style for your outfit\";\n    }\n    if (!images || images.length < 3) {\n      errors.images = \"Please upload at least 3 images\";\n    }\n    if (errors.images || images.style) {\n      setErrors(errors);\n      return;\n    }\n    setRequest(true);\n    setErrors({}); // Clear previous errors\n    // construct the formdata to include image files and the selected style\n    const formData = new FormData();\n    const formDataKeys = [];\n    images.forEach((image, index) => {\n      formData.append(`image${index}`, image.file);\n      formDataKeys.push(`image${index}`);\n    });\n    formData.append(\"style\", style);\n    try {\n      await storeImages(images, formDataKeys); // store images in IndexedDB\n      const apiResponse = await axios.post(`${base_url}/clothes`, formData); // send formData to api\n      setResponse(apiResponse.data.message.content);\n      setRequest(false); // Reset request state\n      setApiCallFinished(true); // Indicate API call is finished\n    } catch (error) {\n      console.error(\"Error in sending request:\", error);\n      setErrors({\n        api: `${error.message}. Please try again.`\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"style\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"style__options\",\n      children: styles.map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `style__option ${s === style ? \"style__option--selected\" : \"\"}`,\n        onClick: () => handleStyleClick(s),\n        children: s\n      }, s, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this), !request && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"style__btn\",\n      onClick: handleClick,\n      children: \"Ask Advisor\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this), request && /*#__PURE__*/_jsxDEV(Box, {\n      className: \"style__loading\",\n      sx: {\n        display: \"flex\"\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n        sx: {\n          color: \"black\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"\",\n      style__errors: true,\n      children: [errors.images && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error\",\n        children: errors.images\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 27\n      }, this), errors.style && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error\",\n        children: errors.style\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 26\n      }, this), errors.api && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error\",\n        children: errors.api\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 24\n      }, this), errors.db && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error\",\n        children: errors.db\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 23\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n};\n_s(StartStyling, \"SYfD7VDatGIYxw145aYqkjrWCqM=\", false, function () {\n  return [useNavigate];\n});\n_c = StartStyling;\nexport default StartStyling;\nvar _c;\n$RefreshReg$(_c, \"StartStyling\");","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","hasImages","clearImages","storeImages","CircularProgress","Box","jsxDEV","_jsxDEV","StartStyling","style","setStyle","response","setResponse","images","_s","errors","setErrors","request","setRequest","apiCallFinished","setApiCallFinished","base_url","process","env","REACT_APP_BASE_URL","navigate","handleStyleClick","styles","clearDatabase","ImagesStoreHasData","error","prevErrors","db","length","handleClick","formData","FormData","formDataKeys","forEach","image","index","append","file","push","apiResponse","post","data","message","content","console","api","className","children","map","s","onClick","fileName","_jsxFileName","lineNumber","columnNumber","sx","display","color","style__errors","_c","$RefreshReg$"],"sources":["C:/Users/HP/OneDrive/Documents/GitHub/Wardrobe-Wizard/client/src/components/StartStyling/StartStyling.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"./StartStyling.scss\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { hasImages, clearImages, storeImages } from \"../../utils/indexDB\";\r\nimport CircularProgress from \"@mui/material/CircularProgress\";\r\nimport Box from \"@mui/material/Box\";\r\nconst StartStyling = ({ style, setStyle, response, setResponse, images }) => {\r\n  const [errors, setErrors] = useState({});\r\n  const [request, setRequest] = useState(false); // the loading state\r\n  const [apiCallFinished, setApiCallFinished] = useState(false);\r\n\r\n  const base_url = process.env.REACT_APP_BASE_URL;\r\n  const navigate = useNavigate();\r\n  const handleStyleClick = (style) => {\r\n    setStyle(style);\r\n  };\r\n\r\n  const styles = [\r\n    \"Streetwear\",\r\n    \"Boho-chic\",\r\n    \"Casual\",\r\n    \"Business Casual\",\r\n    \"Formal\",\r\n    \"Minimalist\",\r\n    \"Elegant\",\r\n    \"Athleisure\",\r\n    \"Girly girl\",\r\n    \"NYC Style\",\r\n    \"Preepy Fashion\",\r\n    \"Punk Fashion\",\r\n    \"Gothic Fashion\",\r\n  ];\r\n  //clear out the old images stored in indexDB upon reload of this page\r\n  useEffect(() => {\r\n    const clearDatabase = async () => {\r\n      try {\r\n        const ImagesStoreHasData = await hasImages();\r\n        if (!ImagesStoreHasData) {\r\n          return;\r\n        }\r\n        await clearImages();\r\n      } catch (error) {\r\n        setErrors((prevErrors) => ({\r\n          ...prevErrors,\r\n          db: \"Failed to clear history images, please try again\",\r\n        }));\r\n      }\r\n    };\r\n    clearDatabase();\r\n  }, []);\r\n  useEffect(() => {\r\n    if (apiCallFinished && response.length > 0) {\r\n      // ensure gpt4 has send back meaningful resonse\r\n      navigate(\"/recommendations\");\r\n      setApiCallFinished(false); // Reset the flag after navigating\r\n    }\r\n  }, [apiCallFinished]); // re-render the page when the response is upadated\r\n\r\n  const handleClick = async () => {\r\n    const errors = {};\r\n    if (!style) {\r\n      errors.style = \"Please selected a style for your outfit\";\r\n    }\r\n    if (!images || images.length < 3) {\r\n      errors.images = \"Please upload at least 3 images\";\r\n    }\r\n    if (errors.images || images.style) {\r\n      setErrors(errors);\r\n      return;\r\n    }\r\n    setRequest(true);\r\n    setErrors({}); // Clear previous errors\r\n    // construct the formdata to include image files and the selected style\r\n    const formData = new FormData();\r\n    const formDataKeys = [];\r\n    images.forEach((image, index) => {\r\n      formData.append(`image${index}`, image.file);\r\n      formDataKeys.push(`image${index}`);\r\n    });\r\n    formData.append(\"style\", style);\r\n\r\n    try {\r\n      await storeImages(images, formDataKeys); // store images in IndexedDB\r\n      const apiResponse = await axios.post(`${base_url}/clothes`, formData); // send formData to api\r\n      setResponse(apiResponse.data.message.content);\r\n      setRequest(false); // Reset request state\r\n      setApiCallFinished(true); // Indicate API call is finished\r\n    } catch (error) {\r\n      console.error(\"Error in sending request:\", error);\r\n      setErrors({ api: `${error.message}. Please try again.` });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"style\">\r\n      <div className=\"style__options\">\r\n        {styles.map((s) => (\r\n          <button\r\n            key={s}\r\n            className={`style__option ${\r\n              s === style ? \"style__option--selected\" : \"\"\r\n            }`}\r\n            onClick={() => handleStyleClick(s)}\r\n          >\r\n            {s}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {!request && (\r\n        <button className=\"style__btn\" onClick={handleClick}>\r\n          Ask Advisor\r\n        </button>\r\n      )}\r\n      {request && (\r\n        <Box className=\"style__loading\" sx={{ display: \"flex\" }}>\r\n          <CircularProgress sx={{ color: \"black\" }} />\r\n        </Box>\r\n      )}\r\n      <div className=\"\" style__errors>\r\n        {errors.images && <p className=\"error\">{errors.images}</p>}\r\n        {errors.style && <p className=\"error\">{errors.style}</p>}\r\n        {errors.api && <p className=\"error\">{errors.api}</p>}\r\n        {errors.db && <p className=\"error\">{errors.db}</p>}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StartStyling;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}